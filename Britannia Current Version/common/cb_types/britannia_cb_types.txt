## normal scopes(including posttitle scopes) ##
# ROOT = receiver
# FROM = giver
# <no scope change> = attacker or receiver
## title scopes ##
# ROOT = receiver
# FROM = giver
# <no scope change> = thirdparty landed title	
#
# the following effects/triggers exists (example execution order: on_success->on_success_title->on_success_posttitle):
# is_valid, is_valid_title, on_add, on_add_title, on_add_posttitle, on_success, on_success_title, on_success_posttitle, on_fail, on_fail_title, on_fail_posttitle, on_reverse_demand, on_reverse_demand_title, on_reverse_demand_posttitle
#
# Added on_attacker_leader_death, on_defender_leader_death and on_thirdparty_death, which all trigger when corresponding character dies
# These three all have war scopes, which currently has the following scope changes: 
# attacker, defender, thirdparty(only valid if thirdparty character is involved), thirdparty_title(only valid if thirdparty title is involved)
#
# ai_will_do: modifies value AI places on the CB compared to other CBs (default: 1) Note: is in title scope
# can_use_gui: If otherwise valid, the CB is listed in the Diplo View, but you can't declare war unless 'can_use_gui' is also valid (also shows a trigger tooltip.)
#

# max_defender_occupation_score/max_attacker_occupation_score - Defines how much war score it is possible for the defender/attacker to gain by occupying provinces. Defaults to 100. Make sure the CB has ticking warscore if using this or you could end up with never-ending wars
# max_defender_battle_score/max_attacker_battle_score - Defines how much score it is possible for the defender/attacker to gain by fighting battles. Defaults to the defines MAX_WARSCORE_FROM_BATTLE_DEFENDERS/MAX_WARSCORE_FROM_BATTLE_ATTACKERS
# hostages_block_cb	- Defaults to "yes". If set to "no", the defender having close relatives of yours imprisoned does not prevent you from declaring war
# attacker_unoccupied_warscore = yes - If attacker completely unoccupied, attacker will get ticking warscore. Only works if no title is targetted
# defender_unoccupied_warscore = yes - If defender completely unoccupied, defender will get ticking warscore. Only works if no title is targetted
# capturing_attacker_is_complete_victory - Whether capturing the attacker as a prisoner is considered automatic victory for the defender. Defaults to yes. If set to no, capture instead gives CAPTURED_HEIR_WAR_SCORE warscore
# capturing_defender_is_complete_victory - Whether capturing the defender as a prisoner is considered automatic victory for the attacker. Defaults to yes. If set to no, capture instead gives CAPTURED_HEIR_WAR_SCORE warscore

### ROMAN IMPERIAL CBs ###
imperial_reclaim = {
	name = CB_IMPERIAL_RECLAIM
	war_name = WAR_NAME_IMPERIAL_RECLAIM
	sprite = 17
	truce_days = 1095
	hostile_against_others = yes
	reflect_titleholder_change = yes
	is_permanent = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allow_distant = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = {
			OR = {
				has_landed_title = e_gaul
				has_landed_title = e_roman_britannia
				AND = {
					age = 20
					has_landed_title = k_gaul
					prestige = 2000
					OR = {
						trait = skilled_tactician
						trait = brilliant_strategist
						martial = 15
						AND = {
							OR = {
								trait = ambitious
								trait = inspiring_leader
							}
							prestige = 2000
							diplomacy = 15
							martial = 12
						}
					}
					independent = yes
					prisoner = no
					NOR = { 
						trait = content
						trait = incapable
						trait = slow
						trait = imbecile
						trait = weak
					}
				}
			}
		}
	}
	
	can_use = {
		ROOT = {
			NOT = { same_realm = FROM }
			is_female = no
			independent = yes
			prisoner = no
		}
	}

	is_valid = {
		ROOT = {
			NOT = { same_realm = FROM }
			OR = {
				has_landed_title = e_gaul
				has_landed_title = e_roman_britannia
				has_landed_title = k_gaul
			}
		}
	}
	
	can_use_title = {
		any_direct_de_jure_vassal_title = {
			location = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
						}
					}
				}
				region = custom_wre
			}
			OR = {
				AND = {
					location = { region = world_gaul }
					ROOT = { 
						OR = {
							has_landed_title = e_gaul 
							has_landed_title = k_gaul 
						}
					}
				}
				AND = {
					location = { region = custom_roman_britannia }
					ROOT = { has_landed_title = e_roman_britannia }
				}
				has_global_flag = gaul_reconquered_roman
				has_global_flag = britannia_reconquered_roman
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
		
	is_valid_title = {
		any_direct_de_jure_vassal_title = {
			location = { region = custom_wre }
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
	
	on_success = {
		ROOT = {
			prestige = 200
		}
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		
		# hidden_tooltip = {
			# ROOT = {	
				# if = {
					# limit = {
						# prestige = 2000
						# martial = 16
						# realm_size = 100
					# }
					# give_nickname = nick_the_conqueror
				# }
			# }
		# }
		
		FROM = {
			prestige = -200
		}
	}

	on_success_title = {
		custom_tooltip = {
			#text = religious_cb_succ_tip
			text = imperial_reclaim_tip
		}
		hidden_tooltip = {
			if = {
				limit = {
					NOT = { culture = ROOT }
				}
				conquest_culture = ROOT
			}
			save_event_target_as = conquered_duchy
			# Try to vassalize any Roman-cultured lords first
			FROM = {
				any_realm_lord = {
					limit = {
						capital_scope = {
							region = custom_wre
							duchy = { title = event_target:conquered_duchy }
						}
						is_roman_culture_trigger = yes
						higher_tier_than = BARON
					}
					set_defacto_liege = ROOT
					opinion = {
						modifier = opinion_subjugated
						who = ROOT
						months = 120
					}
					any_demesne_title = {
						limit = {
							lower_tier_than = DUKE
							NOR = {
								county = { region = custom_wre }
								location = { region = custom_wre }
							}
							NOT = { duchy = { title = event_target:conquered_duchy } }
						}
						usurp_title = FROM
					}
					any_realm_lord = {
						limit = {
							capital_scope = {
								OR = {
									NOT = { region = custom_wre }
									NOT = { duchy = { title = event_target:conquered_duchy } }
								}
							}
						}
						set_defacto_liege = FROM
					}
				}
			}
			# Vassalize all remaining Roman baron-tier characters
			FROM = {
				any_realm_lord = {
					limit = {
						capital_scope = {
							region = custom_wre
							duchy = { title = event_target:conquered_duchy }
						}
						is_roman_culture_trigger = yes
						tier = BARON
					}
					set_defacto_liege = ROOT
					opinion = {
						modifier = opinion_subjugated
						who = ROOT
						months = 120
					}
					any_demesne_title = {
						limit = {
							lower_tier_than = DUKE
							NOR = {
								county = { region = custom_wre }
								location = { region = custom_wre }
							}
							NOT = { duchy = { title = event_target:conquered_duchy } }
						}
						usurp_title = FROM
					}
				}
			}
			# Directly take any remaining titles
			any_direct_de_jure_vassal_title = {
				limit = {
					location = { region = custom_wre }
				}
				if = {
					limit = {
						holder_scope = {
							OR = {
								character = FROM
								is_liege_or_above = FROM
							}
						}
					}
					location = {
						any_province_holding = {
							limit = {
								holder_scope = {
									OR = {
										character = FROM
										is_liege_or_above = FROM
									}
								}
								is_capital = no		# Dealt with afterwards so that county is properly usurped
							}
							usurp_title = ROOT
						}
					}
					usurp_title = ROOT
				}
				if = {
					limit = {
						NOT = { culture = ROOT }
					}
					conquest_culture = ROOT
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 5.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	on_reverse_demand_title = {
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 10
		modifier = {
			factor = 5
			FROM = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 5
			FROM = {
				NOT = { religion_group = ROOT }
			}
		}		
	}
}

imperial_invasion_hibernia = {				# Imperial Conquest
	name = CB_IMPERIAL_INVASION_HIBERNIA
	war_name = WAR_NAME_IMPERIAL_INVASION_HIBERNIA
	sprite = 17
	truce_days = 1095
	battle_warscore_mult = 0.5
	hostile_against_others = yes
	reflect_titleholder_change = yes
	is_permanent = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allow_distant = yes
	
	allowed_to_target_tributaries = no
	
	can_use = {
		ROOT = {
			is_roman_emperor_trigger = yes
			has_global_flag = gaul_reconquered_roman
			has_global_flag = britannia_reconquered_roman
			realm_size = 60
			prisoner = no
		}
	}

	is_valid = {
		ROOT = {
			is_roman_emperor_trigger = yes
			#prisoner = no
		}
	}
	
	can_use_title = {
		any_direct_de_jure_vassal_title = {
			location = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
							can_declare_conquest_war_on_province_trigger = yes
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
								can_declare_conquest_war_on_province_across_sea_trigger = yes
							}
						}
					}
				} 
				OR = {
					region = world_ireland 
					region = world_caledonia
					AND = {
						region = world_britannia_cymry_henogledd
						NOT = { region = custom_roman_britannia }
					}
					AND = {
						OR = {
							region = custom_germania_secunda
							region = custom_germania_tertia
						}
						NOT = { region = custom_wre }
						has_global_flag = expanded_secunda
					}
				}
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
		
	is_valid_title = {
		any_direct_de_jure_vassal_title = {
			OR = {
				region = world_ireland 
				region = world_caledonia
				AND = {
					region = world_britannia_cymry_henogledd
					NOT = { region = custom_roman_britannia }
				}
				AND = {
					OR = {
						region = custom_germania_secunda
						region = custom_germania_tertia
					}
					NOT = { region = custom_wre }
					has_global_flag = expanded_secunda
				}
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
	
	on_success = {
		ROOT = {
			prestige = 200
		}
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		
		FROM = {
			prestige = -200
		}
	}

	on_success_title = {
		custom_tooltip = {
			text = imperial_conquest_tip
		}
		hidden_tooltip = {
			ROOT = {
				gain_settlements_under_title = {
					title = PREV
					enemy = FROM
				}
			}
			any_direct_de_jure_vassal_title = {
				if = {
					limit = {
						NOT = { culture = ROOT }
					}
					conquest_culture = ROOT
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 5.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	on_reverse_demand_title = {
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
}

imperial_invasion_hibernia_condition_placeholder = {				# Imperial Conquest
	name = CB_IMPERIAL_INVASION_HIBERNIA
	war_name = WAR_NAME_IMPERIAL_INVASION_HIBERNIA
	sprite = 17
	truce_days = 1095
	battle_warscore_mult = 0.5
	hostile_against_others = yes
	reflect_titleholder_change = yes
	is_permanent = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allow_distant = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		OR = {
			ROOT = { is_tribal = yes }
			custom_tooltip = {
				text = imperial_invasion_hibernia_province_condition_1
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = imperial_invasion_hibernia_province_condition_2
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = imperial_invasion_hibernia_province_condition_3
				hidden_tooltip = { always = no }
			}
		}
	}
	
	can_use = {
		ROOT = {
			ai = no			# Only for tooltip purposes anyway
			OR = {
				has_landed_title = e_gaul
				has_landed_title = e_roman_britannia
			}
			has_global_flag = gaul_reconquered_roman
			has_global_flag = britannia_reconquered_roman
			realm_size = 60
			prisoner = no
		}
	}

	is_valid = {
		ROOT = {
			OR = {
				has_landed_title = e_gaul
				has_landed_title = e_roman_britannia
			}
			prisoner = no
		}
	}
	
	can_use_title = {
		ROOT = { is_tribal = no }
		any_direct_de_jure_vassal_title = {
			location = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
						}
					} 
				}
				OR = {
					region = world_ireland 
					region = world_caledonia
					AND = {
						region = world_britannia_cymry_henogledd
						NOT = { region = custom_roman_britannia }
					}
				}
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
		NOT = {
			any_direct_de_jure_vassal_title = {
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
								can_declare_conquest_war_on_province_trigger = yes
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									has_owner = yes
									owner = {
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
									can_declare_conquest_war_on_province_across_sea_trigger = yes
								}
							}
						}
					}
					OR = {
						region = world_ireland 
						region = world_caledonia
						AND = {
							region = world_britannia_cymry_henogledd
							NOT = { region = custom_roman_britannia }
						}
					}
				}
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
				}
			}
		}
	}
		
	is_valid_title = {
		any_direct_de_jure_vassal_title = {
			OR = {
				region = world_ireland 
				region = world_caledonia
				AND = {
					region = world_britannia_cymry_henogledd
					NOT = { region = custom_roman_britannia }
				}
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
	
	on_success = {
		ROOT = {
			prestige = 200
		}
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		
		FROM = {
			prestige = -200
		}
	}

	on_success_title = {
		custom_tooltip = {
			text = imperial_conquest_tip
		}
		hidden_tooltip = {
			ROOT = {
				gain_settlements_under_title = {
					title = PREV
					enemy = FROM
				}
			}
			any_direct_de_jure_vassal_title = {
				if = {
					limit = {
						NOT = { culture = ROOT }
					}
					conquest_culture = ROOT
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 5.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	on_reverse_demand_title = {
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 0
	}
}

### CONQUEST and INVASION CBs ###
irishinvasion = {				# Available only to High Kings of Ireland
	name = CB_NAME_IRISHINVASION
	war_name = WAR_NAME_IRISHINVASION
	sprite = 7
	truce_days = 1095
	hostile_against_others = yes
	#check_all_titles = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_ask_to_join_war = no
	reflect_titleholder_change = yes
	is_permanent = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allow_distant = yes
	
	allowed_to_target_tributaries = no
	
	can_use = {
		ROOT = {
			has_landed_title = e_ireland
			prisoner = no
		}
	}

	is_valid = {
		ROOT = { 
			prisoner = no
			has_landed_title = e_ireland
		}
	}
	
	can_use_title = {
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									has_owner = yes
									owner = {
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
								}
							}
						}
					}
				}
			}
		}
		capital_scope = {
			OR = {
				region = custom_alba 
				region = world_henis_wyren 
				region = world_demetia 
			}
		}
	}
		
	is_valid_title = {
		any_direct_de_jure_vassal_title = {
			location = {
				OR = {
					region = custom_alba 
					region = world_henis_wyren 
					region = world_demetia 
				}
			}
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
		}
	}
	
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 150
		}
		ROOT = {
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		
		# hidden_tooltip = {
			# ROOT = {
				# occupy_minors_of_occupied_settlements = FROM
				# gain_all_occupied_titles = FROM			
				# if = {
					# limit = {
						# prestige = 2000
						# martial = 14
						# realm_size = 70
					# }
					# give_nickname = nick_the_conqueror
				# }
			# }
		# }
		
		FROM = {
			prestige = -200
		}
	}

	on_success_title = {
		custom_tooltip = { 
			text = other_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						type = invasion
					}
				}
			}
		}
		if = {
			limit = {
				holder_scope = { character = FROM }
			}
			usurp_title_only = { target = ROOT type = invasion }
		}
		#custom_tooltip = {
		#	text = invasion_succ_tip
		#}
		#if = {
		#	limit = {
		#		higher_tier_than = BARON
		#		NOT = { culture = ROOT }
		#	}
		#	hidden_tooltip = { conquest_culture = ROOT }
		#}
	}

	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 5.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	on_reverse_demand_title = {
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
}

county_conquest = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 7
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_attack_vassals = yes
	reflect_titleholder_change = yes
	
	allow_distant = yes
		
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		county_conquest_can_use_gui_trigger = yes
	}

	can_use = {
		county_conquest_can_use_trigger = yes	
	}

	is_valid = {

	}

	can_use_title = {
		tier = COUNT
		OR = {
			location = {				# Must be bordering province
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
					can_declare_conquest_war_on_province_trigger = yes
				}
			}
			any_direct_de_jure_vassal_title = {	# Or owns barony inside county
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}	
		county_conquest_can_use_title_minus_neighbour_condition_trigger = yes
	}

	is_valid_title = {
		county_conquest_is_valid_title_trigger = yes
	}
	
	on_success_title = {
		county_conquest_on_success_title_effect = yes
	}

	on_fail_title = {
		county_conquest_on_fail_title_effect = yes
	}

	on_reverse_demand = {
		county_conquest_on_reverse_demand_effect = yes
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 100
			e_gaul = { has_holder = no }
			ROOT = {
				has_landed_title = k_gaul
			}
			FROM = {
				NOT = { culture_group = imperiale }
				independent = yes
				OR = {
					has_landed_title = k_franks
					has_landed_title = k_visigoths
					has_landed_title = k_burgundy
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				is_ingvaeonic_culture_trigger = yes
			}
			OR = {
				kingdom = {
					title = k_strathclyde
				}
				duchy = {
					title = d_westrheged
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				culture = gaelic
			}
			OR = {
				title = c_skiel
				title = c_skye
				title = c_westeros
				title = c_rois
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				is_ingvaeonic_culture_trigger = yes
			}
			ROOT = {
				is_ingvaeonic_culture_trigger = yes
			}
		}
		modifier = {
			factor = 0.3
			FROM = {
				culture = oldirish
			}
			ROOT = {
				culture = oldirish
			}
		}		
		modifier = {
			factor = 0.5
			FROM = {
				culture = roman
			}
			ROOT = {
				culture = roman
			}
		}
		modifier = {
			factor = 5
			FROM = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 5
			FROM = {
				NOT = { religion_group = ROOT }
			}
		}
		modifier = {
			factor = 3
			FROM = {
				culture = dane
			}
			ROOT = {
				NOR = {
					culture = dane
					culture = proto_norse
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = { has_claim = PREV }
		}
		modifier = {
			factor = 0.01
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = { title = k_anglia }
			}
			NOT = { year = 520 }
			OR = {
				title = c_calleva
				title = c_spinae
				title = c_hen_vicus
			}
		}
		modifier = {
			factor = 0.001
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = {
					OR = {
						title = k_anglia
						title = k_eastseaxe
						title = d_eastseaxe
						title = d_middleseaxe
					}
				}
				NOT = { has_landed_title = k_sussex }
			}
			NOT = { year = 540 }
			OR = {
				title = c_vindomis
				title = c_venta
				title = c_portus_adurni
				title = c_ambra
			}
		}
		modifier = {
			factor = 0.01
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = {
					OR = {
						title = k_sussex
						title = d_the_belgae
					}
				}
			}
			NOT = { year = 540 }
			OR = {
				title = c_clausentum
				title = c_vectis
			}
		}
		modifier = {
			factor = 3
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = { title = k_sussex }
			}
			OR = {
				title = c_venta
				title = c_portus_adurni
				title = c_vindomis
			}
			NOT = { year = 520 }
		}
		modifier = {
			factor = 4
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = {
					OR = {
						title = k_wessex
						title = d_west_saxons
					}
				}
			}
			OR = {
				title = c_clausentum
				title = c_vectis
				title = c_ambra
				title = c_venta
				title = c_portus_adurni
				title = c_vindomis
				title = c_cunetio
				title = c_hen_vicus
				title = c_spinae
				title = c_calleva
			}
		}
		modifier = {
			factor = 0.01
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = { title = k_anglia }
			}
			NOR = { 
				year = 540
				ROOT = { completely_controls_region = custom_middleanglia }
			}
			kingdom = {
				title = k_powys 
			}
		}
		modifier = {
			factor = 0
			ROOT = { 
				AND = {
					is_ingvaeonic_culture_trigger = yes
					primary_title = { title = k_anglia }
				}
			}
			NOR = {
				year = 540
				ROOT = { completely_controls_region = custom_middleanglia }
			}
			location = { region = world_britannia_lloegyr_guenet }
		}
		modifier = {
			factor = 5
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
				primary_title = { title = k_anglia }
			}
			NOT = { year = 530 }
			OR = {
				region = custom_middleanglia
				region = custom_cilternsaete
			}
		}
		modifier = {
			factor = 0
			ROOT = { 
				has_character_flag = anglia_collapse_target
			}
			has_global_flag = anglia_collapse_start
			NOT = { has_global_flag = anglia_collapsed }
		}
		modifier = {
			factor = 0
			ROOT = { culture = oldfrankish }
			NOT = { year = 495 }
			location = { region = world_hamaland_salland }
		}
		modifier = {
			factor = 0.2
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
			}
			FROM = {
				is_ingvaeonic_culture_trigger = yes
			}
			OR = {
				region = world_germania
				region = custom_frisia
			}
		}
		# Stop AI from using county conquest if it can use duchy invasion instead
		modifier = {
			factor = 0
			# duchy = {		# Doesn't work apparently
				# ROOT = { 
					# can_use_cb = {
						# target = FROM
						# casus_belli = duchy_invasion
						# thirdparty_title = PREV
					# }
				# }
			# }
			duchy_invasion_can_use_trigger = yes
			duchy_invasion_can_use_gui_trigger = yes
		}
		# Stop Franks from attacking Soissons too early and stopping invasion event from triggering
		modifier = {
			factor = 0
			ROOT = { frankish_invasion_gaul_event_trigger_with_neighbour_condition = yes }
			FROM = { has_landed_title = k_gaul }
			year = 485		# Let one initial war happen
		}
	}	
}
county_conquest_condition_placeholder = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 7
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_attack_vassals = yes
	reflect_titleholder_change = yes
	
	allow_distant = yes
		
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		county_conquest_can_use_gui_trigger = yes
		OR = {
			ROOT = { is_tribal = yes }
			custom_tooltip = {
				text = county_conquest_province_condition_1
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = county_conquest_province_condition_2
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = county_conquest_province_condition_3
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = county_conquest_province_condition_4
				hidden_tooltip = { always = no }
			}
		}
	}

	can_use = {
		county_conquest_can_use_trigger = yes	
	}

	is_valid = {

	}

	can_use_title = {
		tier = COUNT
		ROOT = { is_tribal = no }
		OR = {
			location = {				# Must be bordering province
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
				NOT = {
					any_neighbor_province = {
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
						OR = {
							PREV = { culture_group = ROOT }
							PREV = { NOT = { any_province_holding = { holding_type = tribal } } }
							NOT = { any_province_holding = { holding_type = tribal } }
						}
					}
				}
			}
			any_direct_de_jure_vassal_title = {	# Or owns barony inside county
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}	
		county_conquest_can_use_title_minus_neighbour_condition_trigger = yes
	}

	is_valid_title = {
		county_conquest_is_valid_title_trigger = yes
	}
	
	on_success_title = {
		county_conquest_on_success_title_effect = yes
	}

	on_fail_title = {
		county_conquest_on_fail_title_effect = yes
	}

	on_reverse_demand = {
		county_conquest_on_reverse_demand_effect = yes
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 0
	}	
}
county_conquest_tribal = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 7
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_attack_vassals = yes
	reflect_titleholder_change = yes
		
	allowed_to_target_tributaries = no

	can_use_gui = {
		ROOT = { 
			is_adult = yes 
			is_incapable = no
			prisoner = no
			NOT = { has_character_modifier = county_conquest_tribal_timer }
			martial = 12
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { 
					culture_group = ROOT
					OR = {
						is_tribal = yes
						ROOT = { government = high_tribal_government }
					}
				}
			}
			ROOT = { prestige = 5000 }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { 
					NOT = { culture_group = ROOT } 
					is_tribal = yes
				}
			}
			ROOT = { prestige = 2000 }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { is_tribal = no }
			}
			ROOT = { prestige = 1000 }
		}
	}
	
	can_use = {
		FROM = {
			NOT = { same_realm = ROOT }
		}
		ROOT = {
			independent = yes
			OR = {
				government = tribal_government
				AND = {
					government = high_tribal_government
					OR = {
						AND = {
							ROOT = { is_gaelic_culture_trigger = yes }
							FROM = { is_gaelic_culture_trigger = yes }
						}
						AND = {
							ROOT = { is_north_germanic_trigger = yes }
							FROM = { is_north_germanic_trigger = yes }
						}
					}
				}
			}
		}
	}

	can_use_title = {
		tier = COUNT
		OR = {
			location = {				# Must be bordering province
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
			any_direct_de_jure_vassal_title = {	# Or owns barony inside county
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}	
		county_conquest_can_use_title_minus_neighbour_condition_trigger = yes
	}

	is_valid_title = {
		county_conquest_is_valid_title_trigger = yes
	}
	
	on_add = {
		hidden_tooltip = {
			ROOT = {
				if = { 
					limit = { 
						FROM = {
							culture_group = ROOT
							is_tribal = yes
						}
					}
					add_character_modifier = {
						name = county_conquest_tribal_timer 
						duration = 3650
					}
				}
				else_if = { 
					limit = { 
						FROM = {
							is_tribal = yes
						}
					}
					add_character_modifier = {
						name = county_conquest_tribal_timer 
						duration = 1825
					}
				}
				else = {
					add_character_modifier = {
						name = county_conquest_tribal_timer 
						duration = 730
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					culture_group = ROOT
					is_tribal = yes
				}
			}
			ROOT = { prestige = -750 }
		}
		else_if = {
			limit = {
				FROM = {
					is_tribal = yes
				}
			}
			ROOT = { prestige = -300 }
		}
		else = {
			ROOT = { prestige = -100 }
		}
	}
	
	on_success_title = {
		county_conquest_on_success_title_effect = yes
	}

	on_fail_title = {
		county_conquest_on_fail_title_effect = yes
	}

	on_reverse_demand = {
		county_conquest_on_reverse_demand_effect = yes
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				culture = gaelic
			}
			OR = {
				title = c_skiel
				title = c_skye
				title = c_westeros
				title = c_rois
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				is_ingvaeonic_culture_trigger = yes
			}
			ROOT = {
				is_ingvaeonic_culture_trigger = yes
			}
		}
		modifier = {
			factor = 0.3
			FROM = {
				culture = oldirish
			}
			ROOT = {
				culture = oldirish
			}
		}
		modifier = {
			factor = 5
			FROM = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 5
			FROM = {
				NOT = { religion_group = ROOT }
			}
		}
		modifier = {
			factor = 3
			FROM = {
				culture = dane
			}
			ROOT = {
				NOR = {
					culture = dane
					culture = proto_norse
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = { has_claim = PREV }
		}
		modifier = {
			factor = 0
			ROOT = {
				is_frankish_culture_trigger = yes
			}
			FROM = {
				OR = {
					culture = armorican
					culture = breton
				}
			}
			location = {
				region = world_gaul_lugdunensis_armorica
			}
		}
		modifier = {
			factor = 0
			ROOT = { 
				has_character_flag = anglia_collapse_target
			}
			has_global_flag = anglia_collapse_start
			NOT = { has_global_flag = anglia_collapsed }
		}
		modifier = {
			factor = 0
			ROOT = { culture = oldfrankish }
			NOT = { year = 495 }
			location = { region = world_hamaland_salland }
		}
		modifier = {
			factor = 0.2
			ROOT = { 
				is_ingvaeonic_culture_trigger = yes
			}
			FROM = {
				is_ingvaeonic_culture_trigger = yes
			}
			OR = {
				region = world_germania
				region = custom_frisia
			}
		}
	}	
}
take_vassal_tribal = {
	name = CB_NAME_VASSALIZATION
	war_name = WAR_NAME_VASSALIZATION
	sprite = 6
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_attack_vassals = yes
	reflect_titleholder_change = yes
		
	allowed_to_target_tributaries = no

	can_use_gui = {
		ROOT = { 
			is_adult = yes 
			is_incapable = no
			prisoner = no
			martial = 4
			prestige = 1500
			NOT = { has_character_modifier = take_vassal_tribal_timer }
		}
	}
	
	can_use = {
		FROM = {
			NOT = { same_realm = ROOT }
			is_tribal = yes
		}
		ROOT = {
			OR = {
				government = tribal_government
				AND = {
					government = high_tribal_government
					NOR = {
						is_brythonic_culture_trigger = yes
						culture_group = imperiale
						is_romanized_germanic_trigger = yes
					}
				}
			}
		}
	}

	can_use_title = {
		tier = COUNT
		location = {				# Must be bordering province
			any_neighbor_province = {
				OR = {
					AND = {
						has_owner = yes
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
					AND = {
						is_land = no
						any_neighbor_province = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
							OR = {
								is_isolated_island_trigger = yes
								PREVPREV = { is_isolated_island_trigger = yes }
							}
						}
					}
				}
			}
		}
		holder_scope = {
			OR = {
				AND = {
					ROOT = { government = tribal_government }
					NOT = { num_of_count_titles_in_realm = 7 }
				}
				NOT = { num_of_count_titles_in_realm = 4 }
			}
			NOT = { character = FROM }
		}
		OR = {
			ROOT = { independent = yes }
			NOT = { holder_scope = { higher_tier_than = ROOT } }
		}
		county_conquest_can_use_title_minus_neighbour_condition_trigger = yes
	}

	is_valid_title = {
		county_conquest_or_neighbouring_isolated_island_is_valid_title_trigger = yes
	}
	
	on_add = {
		hidden_tooltip = {
			ROOT = {
				if = {
					limit = { government = high_tribal_government }
					add_character_modifier = {
						name = take_vassal_tribal_timer 
						duration = 1460
					}
				}
			}
		}
	}
	
	on_add_title = {
		if = {
			limit = { ROOT = { government = tribal_government } }
			if = {
				limit = { holder_scope = { num_of_count_titles_in_realm = 5 } }
				ROOT = { prestige = -300 }
			}
			else_if = {
				limit = { holder_scope = { num_of_count_titles_in_realm = 3 } }
				ROOT = { prestige = -200 }
			}
			else_if = {
				limit = { holder_scope = { num_of_count_titles_in_realm = 2 } }
				ROOT = { prestige = -150 }
			}
			else = {
				ROOT = { prestige = -100 }
			}
		}
		else = {
			if = {
				limit = { holder_scope = { num_of_count_titles_in_realm = 3 } }
				ROOT = { prestige = -300 }
			}
			else_if = {
				limit = { holder_scope = { num_of_count_titles_in_realm = 2 } }
				ROOT = { prestige = -200 }
			}
			else = {
				ROOT = { prestige = -100 }
			}
		}
	}
	
	on_success_title = {
		holder_scope = {
			hidden_tooltip = { set_defacto_liege = THIS }
			vassalize_under_ROOT_tribal_effect = yes
		}
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = {
				NOT = { character = ROOT }
			}
			hidden_tooltip = { participation_scaled_prestige = 75 }
		}
	}

	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		if = {
			limit = { ROOT = { has_character_flag = foederate_revolt } }
			hidden_tooltip = { ROOT = { character_event = {	id = 313040 } } }
		}
		FROM = {
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		if = {
			limit = { ROOT = { has_character_flag = foederate_revolt } }
			hidden_tooltip = { ROOT = { character_event = {	id = 313039 } } }
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				culture = gaelic
			}
			OR = {
				title = c_skiel
				title = c_skye
				title = c_westeros
				title = c_rois
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				is_ingvaeonic_culture_trigger = yes
			}
			ROOT = {
				is_ingvaeonic_culture_trigger = yes
			}
		}
		modifier = {
			factor = 0.3
			FROM = {
				culture = oldirish
			}
			ROOT = {
				culture = oldirish
			}
		}
	}	
}
cultural_reconquest = {
	name = CB_NAME_CULTURAL_RECONQUEST
	war_name = WAR_NAME_CULTURAL_RECONQUEST
	sprite = 6
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes # if permanent, setting this to true will check against all of someones titles, including vassal held titles
	press_claim = yes
	can_ask_to_join_war = yes
	can_attack_vassals = yes
	reflect_titleholder_change = yes
	
	#allow_distant = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = { prestige = 400 }
	}
	
	can_use = {
		ROOT = {
			prisoner = no
			NOR = { 
				same_realm = FROM
				culture = FROM 
			}
			age = 15
			is_female = no
		}
		NAND = {					# Prevents zealous rulers from declaring war on others of the same religion
			ROOT = {
				OR = {
					trait = zealous
					trait = holy_warrior
				}
			}
			FROM = { religion = ROOT }
		}
	}

	is_valid = {
		ROOT = {
			NOR = { 
				same_realm = FROM
				culture = FROM 
			}
		}
		NAND = {					# Prevents zealous rulers from declaring war on others of the same religion
			ROOT = {
				OR = {
					trait = zealous
					trait = holy_warrior
				}
			}
			FROM = { religion = ROOT }
		}
	}
	
	can_use_title = {
		tier = COUNT
		OR = {
			location = {				# Must be bordering province
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
			any_direct_de_jure_vassal_title = {	# Or owns barony inside county
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}				
			location = {			# One sea province away allowed for Ynys Manaw
				any_neighbor_province = {
					is_land = no
					any_neighbor_province = {
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
				region = world_britannia_cymry_henogledd_ynysmanaw
			}
		}
		OR = {
			AND = {								# Frisians
				ROOT = { 
					OR = {
						culture = oldfrisian
						culture = frisian 
					}
				}
				FROM = { 
					NOR = {
						culture = oldfrisian
						culture = frisian 
					}
				}
				region = custom_frisia
			}
			AND = {								# Picts
				ROOT = { culture = pictish }
				FROM = {
					NOT = { culture = pictish }
					NOT = { culture = gaelic }
				}
				region = world_caledonia
				NOT = { region = world_caledonia_dalriada }
			}
			AND = {								# Cumbrians
				ROOT = { culture = cumbrian }
				FROM = {
					is_brythonic_culture_trigger = no
				}
				region = world_britannia_cymry_henogledd
			}
			AND = {								# Britons
				ROOT = { culture = briton }
				FROM = {
					is_brythonic_culture_trigger = no
				}
				OR = {
					region = world_britannia_cymry_wales
					region = world_britannia_cymry_cornwall_proper
				}
			}
		}		
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = { same_realm = ROOT }
			}
		}
		# Protection for Demetia
		NAND = {
			kingdom = {
				title = k_demetia
			}
			FROM = {
				culture = oldirish
			}
		}
	}
	
	is_valid_title = {
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = { same_realm = ROOT }
			}
		}
	}
	
	on_add = {
		ROOT = {
			prestige = -75
		}
	}

	on_success_title = {
#		any_de_jure_vassal_title = { # take all baronies under the one we're fighting for
#			limit = {
#				has_holder = yes
#				NOT = {
#					de_facto_liege = PREV
#				}
#				holder_scope = {
#					OR = {
#						character = FROM
#						is_liege_or_above = FROM
#					}
#				}
#			}
#			usurp_title_plus_barony_if_unlanded = ROOT
#		}
		ROOT = {
			gain_settlements_under_title = {
				title = PREV
				enemy = FROM
			}
		}
		usurp_title = ROOT
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = {
				NOT = { character = ROOT }
			}
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 0.75
			FROM = {
				religion = ROOT
			}
		}
		modifier = {
			factor = 1.25
			FROM = {
				NOT = { religion_group = ROOT }
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				NOR = {
					trait = ambitious
					trait = proud
					trait = war_hero
					trait = authoritative
					trait = inspiring_leader
					trait = honorable
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				higher_tier_than = ROOT
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				lower_tier_than = ROOT
			}
		}	
		modifier = {
			factor = 0.5
			ROOT = {
				independent = no
			}
		}		
	}	
}
duchy_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 7
	truce_days = 2190
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	reflect_titleholder_change = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		duchy_invasion_can_use_gui_trigger = yes
	}
	
	can_use = {
		duchy_invasion_can_use_trigger = yes
	}
	
	can_use_title = {
		OR = {
			AND = {
				ROOT = {
					has_character_flag = duchy_invader
				}
				FROM = { 
					has_character_flag = duchy_invasion_target
				}
			}
			AND = {
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
					OR = {
						location = {
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
								can_declare_conquest_war_on_province_trigger = yes
							}
						}
						any_direct_de_jure_vassal_title = {
							holder_scope = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
					}
				}
				duchy_invasion_can_use_title_minus_neighbour_condition_trigger = yes
			}
		}
	}
	
	is_valid = {
	}
	
	on_add = {
		ROOT = {
			clr_character_flag = duchy_invader
		}
		FROM = {
			clr_character_flag = duchy_invasion_target
		}
	}
	
	on_success = {
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		FROM = {
			prestige = -200
		}
	}
	
	on_success_title = {
		custom_tooltip = {
			text = duchy_invasion_cb_succ_tip
			hidden_tooltip = {
				capital_scope = {
					county = {
						if = {
							limit = {
								holder_scope = {
									top_liege = {
										character = FROM
									}
								}
							}
							set_title_flag = usurp_capital
						}
					}
				}
				if = {
					limit = { FROM = { independent = yes } }
					FROM = { set_character_flag = was_independent }
				}
				ROOT = {
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
					}
				}
				any_direct_de_jure_vassal_title = {
					limit = {
						holder_scope = {
							character = ROOT
						}
					}
					conquest_culture = ROOT
				}
				FROM = {
					if = {
						limit = { 
							independent = no 
							has_character_flag = was_independent
							liege = { character = ROOT }
						}
						any_vassal = {
							limit = { higher_tier_than = BARON }
							set_defacto_liege = ROOT
						}
						any_demesne_title = {
							limit = { higher_tier_than = COUNT }
							destroy_landed_title = THIS
						}
						set_defacto_liege = ROOT
					}
					clr_character_flag = was_independent 
				}				
			}
		}
		capital_scope = {
			county = {
				if = {
					limit = {
						OR = {
							holder_scope = {
								top_liege = {
									character = FROM
								}
							}
							has_title_flag = usurp_capital
						}
					}
					usurp_title = ROOT
					clr_title_flag = usurp_capital
				}
			}
		}
	}
	
	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 5
		modifier = {
			factor = 1000
			ROOT = {
				culture_group = germanic
				independent = yes
				OR = {
					AND = {
						has_landed_title = k_franks
						OR = {
							NOT = { has_global_flag = frankish_kingdoms_united }
							year = 490
						}
						has_global_flag = frankish_war_480
					}
					has_landed_title = k_visigoths
					has_landed_title = k_burgundy
				}
			}
			FROM = {
				has_landed_title = k_gaul
			}
		}
		modifier = {
			factor = 1000
			ROOT = {
				culture_group = germanic
				independent = yes
				OR = {
					has_landed_title = k_franks
					has_landed_title = k_neustria
					has_landed_title = k_orleans
					has_landed_title = k_ripuarian_franks
				}
			}
			FROM = {
				OR = {
					culture_group = imperiale
					culture_group = celtic
				}
				OR = {
					NOT = { has_landed_title = k_benoic }
					has_global_flag = frankish_invasion_483
				}
			}
			capital_scope = {
				region = custom_roman_soissons_area
			}
			OR = {
				has_global_flag = soissons_conquered
				year = 510
			}
		}
		modifier = {			# Direct Franks towards Benoic ASAP
			factor = 1000
			ROOT = {
				culture_group = germanic
				independent = yes
				has_landed_title = k_franks
			}
			FROM = {
				OR = {
					culture_group = imperiale
					culture_group = celtic
				}
			}
			has_global_flag = soissons_conquered
			NOT = { has_global_flag = frankish_invasion_483 }
			OR = {
				title = d_baiocassia
				title = d_bayeux
				title = d_lexovia
				title = d_lisieux
			}
		}
		modifier = {			# Direct Franks towards Benoic ASAP
			factor = 100
			ROOT = {
				culture_group = germanic
				independent = yes
				has_landed_title = k_franks
			}
			FROM = {
				OR = {
					culture_group = imperiale
					culture_group = celtic
				}
			}
			has_global_flag = soissons_conquered
			NOT = { has_global_flag = frankish_invasion_483 }
			OR = {
				title = d_eburovicia
				title = d_evreux
				title = d_sagia
				title = d_hiemois
			}
		}
		modifier = {
			factor = 0
			ROOT = { culture = oldfrankish }
			NOT = { year = 495 }
			capital_scope = {
				region = world_hamaland_salland
			}
		}
		# Stop Franks from attacking Soissons too early and stopping invasion event from triggering
		modifier = {
			factor = 0
			ROOT = { frankish_invasion_gaul_event_trigger_with_neighbour_condition = yes }
			FROM = { has_landed_title = k_gaul }
		}
	}
}
duchy_invasion_condition_placeholder = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 7
	truce_days = 2190
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		duchy_invasion_can_use_gui_trigger = yes
		OR = {
			ROOT = { is_tribal = yes }
			custom_tooltip = {
				text = duchy_invasion_province_condition_1
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = duchy_invasion_province_condition_2
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = duchy_invasion_province_condition_3
				hidden_tooltip = { always = no }
			}
			custom_tooltip = {
				text = duchy_invasion_province_condition_4
				hidden_tooltip = { always = no }
			}
		}
	}
	
	can_use = {
		duchy_invasion_can_use_trigger = yes
	}
	
	can_use_title = {
		any_direct_de_jure_vassal_title = {
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
			location = {
				any_neighbor_province = {
					has_owner = yes
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
				NOT = {
					any_neighbor_province = {
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
						OR = {
							PREV = { culture_group = ROOT }
							PREV = { NOT = { any_province_holding = { holding_type = tribal } } }
							NOT = { any_province_holding = { holding_type = tribal } }
						}
					}
				}
			}
		}
		duchy_invasion_can_use_title_minus_neighbour_condition_trigger = yes
	}
	
	is_valid = {
	}
	
	on_add = {
		ROOT = {
			clr_character_flag = duchy_invader
		}
		FROM = {
			clr_character_flag = duchy_invasion_target
		}
	}
	
	on_success = {
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 150
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		FROM = {
			prestige = -200
		}
	}
	
	on_success_title = {
		custom_tooltip = {
			text = duchy_invasion_cb_succ_tip
			hidden_tooltip = {
				capital_scope = {
					county = {
						if = {
							limit = {
								holder_scope = {
									top_liege = {
										character = FROM
									}
								}
							}
							set_title_flag = usurp_capital
						}
					}
				}
				ROOT = {
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
					}
				}
				any_direct_de_jure_vassal_title = {
					limit = {
						holder_scope = {
							character = ROOT
						}
					}
					conquest_culture = ROOT
				}
			}
		}
		capital_scope = {
			county = {
				if = {
					limit = {
						OR = {
							holder_scope = {
								top_liege = {
									character = FROM
								}
							}
							has_title_flag = usurp_capital
						}
					}
					usurp_title = ROOT
					clr_title_flag = usurp_capital
				}
			}
		}
	}
	
	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 0
	}
}

duchy_invasion_event = {			# For event invasions where you want to usurp everything in the duchy
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 7
	truce_days = 2190
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	
	allowed_to_target_tributaries = no
	
	can_use = {
		OR = {
			ROOT = { has_character_flag = saxon_gallic_invasion_allowed }
			AND = {
				ROOT = {
					has_character_flag = duchy_invader
				}
				FROM = { 
					has_character_flag = duchy_invasion_target
				}
			}
		}
	}
	
	can_use_title = {
		OR = {
			ROOT = { has_character_flag = duchy_invader }
			AND = {
				ROOT = { has_character_flag = saxon_gallic_invasion_allowed }
				any_direct_de_jure_vassal_title = {
					location = {
						region = custom_northwest_gaul
						any_neighbor_province = {
							#is_land = no
							OR = {
								province_id = 304
								province_id = 294
								province_id = 299
								province_id = 298
								province_id = 286
								province_id = 284
								province_id = 285
							}
						}
					}
					holder_scope = {
						NOT = { culture_group = germanic }
						top_liege = { NOT = { culture_group = germanic } }
					}
				}
			}
		}
	}
	
	is_valid = {
	}
	
	on_add = {
		ROOT = {
			if = {
				limit = {
					has_character_flag = saxon_gallic_invader
					ai = no
				}
				character_event = { id = 301618 }
			}
			clr_character_flag = duchy_invader
			clr_character_flag = saxon_gallic_invasion_allowed
		}
		FROM = {
			clr_character_flag = duchy_invasion_target
		}
	}
	
	on_add_title = {
		# Inform defender
		hidden_tooltip = {
			if = {
				limit = { ROOT = { has_character_flag = saxon_gallic_invader } }
				any_playable_ruler = {
					limit = {
						same_realm = FROM
						any_realm_province = {
							duchy = {
								title = PREVPREVPREV
							}
						}
					}
					character_event = { id = 301615 }
				}
			}
		}
	}
	
	on_success = {
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 150
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		FROM = {
			prestige = -200
		}
	}
	
	on_success_title = {
		custom_tooltip = {
			text = duchy_invasion_event_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					gain_settlements_under_title = {
						title = PREV
						enemy = FROM
					}
				}
				any_direct_de_jure_vassal_title = {
					limit = {
						holder_scope = {
							character = ROOT
						}
					}
					conquest_culture = ROOT
				}
			}
		}
		if = {
			limit = { ROOT = { has_character_flag = saxon_gallic_invader } }
			custom_tooltip = {
				text = saxon_gaul_duchy_invasion_event_succ_tip
				hidden_tooltip = {
					ROOT = {
						PREV = { set_title_flag = new_duchy }
						character_event = { id = 301619 }
						set_defacto_liege = THIS
						PREV = { clr_title_flag = new_duchy }
					}
				}
			}
			ROOT = { clr_character_flag = saxon_gallic_invader }
		}
	}
	
	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
			clr_character_flag = saxon_gallic_invader
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			clr_character_flag = saxon_gallic_invader
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 1
	}
}
duchy_invasion_tribal = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 7
	truce_days = 720
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	reflect_titleholder_change = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = {
			AND = {
				age = 20
				prestige = 5000
				martial = 15
				prisoner = no
				NOR = { 
					is_incapable = yes
					trait = slow
					trait = imbecile
					trait = weak
				}
			}
		}
	}
	
	can_use = {
		ROOT = {
			government = tribal_government
			independent = yes
			higher_tier_than = COUNT
		}
		FROM = { is_tribal = no }
	}
	
	can_use_title = {
		any_direct_de_jure_vassal_title = {
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
			OR = {
				location = {
					any_neighbor_province = {
						has_owner = yes
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
						can_declare_conquest_war_on_province_trigger = yes
					}
				}
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
	}
	
	is_valid_title = {
		any_direct_de_jure_vassal_title = {
			holder_scope = {
				OR = {
					character = FROM
					is_liege_or_above = FROM
				}
			}
			OR = {
				location = {
					any_neighbor_province = {
						has_owner = yes
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
				any_direct_de_jure_vassal_title = {
					holder_scope = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
	}
	
	on_add = {
		ROOT = { prestige = -300 }
	}
	
	on_success = {
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			prestige = -200
		}
	}
	
	on_success_title = {
		ROOT = {
			vassalize_or_take_under_title_destroy_duchies = {
				title = PREV
				enemy = FROM
			}
		}
	}
	
	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 0
			ROOT = { culture = oldfrankish }
			NOT = { year = 495 }
			capital_scope = {
				region = world_hamaland_salland
			}
		}
	}
}
bid_for_independence_history = {
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_INDEPENDENCE
	sprite = 12
	truce_days = 1095
	
	is_permanent = yes
	is_independence = yes

	can_use = {
		always = no
	}

	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			higher_tier_than = ROOT
		}
	}

	on_success = {
		if = {
			limit = {
				FROM = {
					independent = no
				}
			}
			FROM = {
				liege = {
					ROOT = {
						set_defacto_liege = PREV
					}
				}
			}
		}

		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}

		hidden_tooltip = {
			ROOT = {
				prestige = 100
				any_demesne_title = {
					add_pressed_claim = FROM
				}
			}
		}
		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}

		FROM = {
			any_demesne_title = { # All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
#					is_titular = no
					NOT = { has_law = crown_authority_0 }
				}
				if = {
					limit = { has_law = crown_authority_1 }
					add_law = crown_authority_0
				}
				if = {
					limit = { has_law = crown_authority_2 }
					add_law = crown_authority_1
				}
				if = {
					limit = { has_law = crown_authority_3 }
					add_law = crown_authority_2
				}
				if = {
					limit = { has_law = crown_authority_4 }
					add_law = crown_authority_3
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -50
			set_defacto_liege = FROM
		}
		ROOT = {
			participation_scaled_prestige = -50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = -50 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -100
			set_defacto_liege = FROM
			prisoner = FROM
		}
		ROOT = {
			participation_scaled_prestige = -100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = -100 }
		}
		FROM = {
			prestige = 50
		}
	}

	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}

		end_war = invalid
		
		ROOT = { set_defacto_liege = FROM }		
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 150
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 90
	}
}
bid_for_independence_tributaries_soissons = {
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_INDEPENDENCE
	sprite = 12
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = no
	truce_days = 1095
	reflect_titleholder_change = yes

	can_use = {
		ROOT = { has_character_flag = soissons_revolt_leader }
	}

	on_success = {
		ROOT = { clr_character_flag = soissons_revolt_leader }
		FROM = { remove_tributary = ROOT }
		any_attacker = {
			limit = { 
				OR = {
					is_tributary = {
						type = client_state
						suzerain = FROM
					}
					is_tributary = {
						type = foederati
						suzerain = FROM
					}
				}
				primary_title = {
					OR = {
						kingdom = { title = k_gaul }
						kingdom = { title = k_benoic }
						kingdom = { title = k_broceliande }
						title = k_benoic
						title = k_broceliande
					}
				}
			}
			FROM = { remove_tributary = PREV }
		}

		hidden_tooltip = {
			ROOT = {
				prestige = 100
			}
		}
		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}

		FROM = {
			if = {
				limit = { NOT = { has_dlc = "Zeus" } }
				any_demesne_title = { # All titles
					limit = {
						OR = {
							tier = king
							tier = emperor
						}
	#					is_titular = no
						NOT = { has_law = crown_authority_0 }
					}
					if = {
						limit = { has_law = crown_authority_1 }
						add_law = crown_authority_0
					}
					if = {
						limit = { has_law = crown_authority_2 }
						add_law = crown_authority_1
					}
					if = {
						limit = { has_law = crown_authority_3 }
						add_law = crown_authority_2
					}
					if = {
						limit = { has_law = crown_authority_4 }
						add_law = crown_authority_3
					}
				}
			}
		}
	}

	on_fail = {
		ROOT = { clr_character_flag = soissons_revolt_leader }
		ROOT = {
			prestige = -50
		}
		ROOT = {
			participation_scaled_prestige = -50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = -50 }
		}
	}

	on_reverse_demand = {
		ROOT = { clr_character_flag = soissons_revolt_leader }
		ROOT = { 
			prestige = -100
			if = {
				limit = { tier = KING }
				any_vassal = {
					limit = {
						NOT = {
							ROOT = {
								any_demesne_title = {
									higher_tier_than = PREVPREV
									NOT = { higher_tier_than = DUKE }
								}
							}
						}
					}
					set_defacto_liege = FROM
				}
				any_demesne_title = {
					limit = { tier = KING }
					destroy_landed_title = THIS
				}
			}
			set_defacto_liege = FROM
		}
		any_attacker = {
			limit = { 
				OR = {
					is_tributary = {
						type = client_state
						suzerain = FROM
					}
					is_tributary = {
						type = foederati
						suzerain = FROM
					}
				}
				primary_title = {
					OR = {
						kingdom = { title = k_gaul }
						kingdom = { title = k_benoic }
						kingdom = { title = k_broceliande }
						title = k_benoic
						title = k_broceliande
					}
				}
			}
			prestige = -100
			if = {
				limit = { tier = KING }
				any_vassal = {
					limit = {
						OR = {
							tier = DUKE
							AND = {
								tier = COUNT
								NOT = { PREV = { any_demesne_title = { tier = DUKE } } }
							}
							AND = {
								tier = BARON
								NOT = { 
									PREV = { 
										any_demesne_title = { 
											higher_tier_than = BARON 
											lower_tier_than = KING
										} 
									} 
								}
							}
						}
					}
					set_defacto_liege = FROM
				}
				any_demesne_title = {
					limit = { tier = KING }
					destroy_landed_title = THIS
				}
			}
			set_defacto_liege = FROM
		}
		ROOT = {
			participation_scaled_prestige = -100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = -100 }
		}
		FROM = {
			prestige = 150
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = { 
		factor = 1
	}
}

### HIGH KINGDOMS CBs ###
disputeBritanniaHighKingship = {
	name = CB_NAME_DISPUTEBRITANNIA
	war_name = WAR_NAME_DISPUTEBRITANNIA
	sprite = 1
	truce_days = 730
	hostile_against_others = yes
	can_ask_to_join_war = no
	allow_whitepeace = no				# Test
	press_claim = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allow_distant = yes
	
	can_use = {
		ROOT = { has_character_flag = HK_challenger }
		ROOT = { prisoner = no }
		FROM = { has_character_flag = HK_challenged_oppositor }
	}
	
	can_use_title = {
		tier = KING
		FROM = {
			has_landed_title = PREV
		}
	}
	
	is_valid = {
		ROOT = { has_character_flag = HK_challenger }
		FROM = { has_character_flag = HK_challenged_oppositor }
	}
	
	on_success_title = {
		clr_global_flag = HK_britannia_claim
		
		ROOT = {
			participation_scaled_prestige = 100
			hidden_tooltip = {
				ROOT = {
					clr_character_flag = HK_challenger
					set_character_flag = HK_challenge_winner
					remove_character_modifier = HK_britannia_claim_timer
				}
				FROM = {
					clr_character_flag = HK_challenged_oppositor
					set_character_flag = HK_challenge_loser
				}
			}
			hidden_tooltip = {
				any_playable_ruler = {
					limit = {
						is_HK_britannia_relevant_trigger = yes
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = 312169 }
				}
			}
		}
		
		FROM = {
			prestige = -100
		}
	}

	on_fail_title = {
		clr_global_flag = HK_britannia_claim
		ROOT = {
			prestige = -100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			clr_character_flag = HK_challenger
			set_character_flag = HK_challenge_loser
			remove_claim = e_britannia
		}
		FROM = {
			clr_character_flag = HK_challenged_oppositor
			set_character_flag = HK_challenge_winner
		}
	}

	on_reverse_demand = {
		clr_global_flag = HK_britannia_claim
		ROOT = {
			prestige = -150
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			participation_scaled_prestige = 150
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 150 }
		}
		ROOT = {
			clr_character_flag = HK_challenger
			set_character_flag = HK_challenge_loser
			remove_claim = e_britannia
			hidden_tooltip = {
				any_playable_ruler = {
					limit = {
						is_HK_britannia_relevant_trigger = yes
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = 312169 }
				}
			}
		}
		FROM = {
			clr_character_flag = HK_challenged_oppositor
			set_character_flag = HK_challenge_winner
		}
	}
	
	on_invalidation = {
		clr_global_flag = HK_britannia_claim
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 90
	}
}
disputeAenglandHighKingship = {
	name = CB_NAME_DISPUTEAENGLAND
	war_name = WAR_NAME_DISPUTEAENGLAND
	sprite = 1
	truce_days = 730
	hostile_against_others = yes
	can_ask_to_join_war = no
	allow_whitepeace = no				# Test
	press_claim = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allow_distant = yes
	
	can_use = {
		ROOT = { has_character_flag = HK_aengland_challenger }
		ROOT = { prisoner = no }
		FROM = { has_character_flag = HK_aengland_challenged_oppositor }
	}
	
	can_use_title = {
		tier = KING
		FROM = {
			has_landed_title = PREV
		}
	}
	
	is_valid = {
		ROOT = { has_character_flag = HK_aengland_challenger }
		FROM = { has_character_flag = HK_aengland_challenged_oppositor }
	}
	
	on_success_title = {
		clr_global_flag = HK_aengland_claim
		ROOT = {
			participation_scaled_prestige = 100
			hidden_tooltip = {
				ROOT = {
					clr_character_flag = HK_aengland_challenger
					set_character_flag = HK_aengland_challenge_winner
					remove_character_modifier = HK_aengland_claim_timer
				}
				FROM = {
					clr_character_flag = HK_aengland_challenged_oppositor
					set_character_flag = HK_aengland_challenge_loser
				}
			}
			hidden_tooltip = {
				any_playable_ruler = {
					limit = {
						is_HK_aengland_relevant_trigger = yes
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = 3121698 }
				}
			}
		}
		
		FROM = {
			prestige = -100
		}
	}

	on_fail_title = {
		clr_global_flag = HK_aengland_claim
		ROOT = {
			prestige = -100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			clr_character_flag = HK_aengland_challenger
			set_character_flag = HK_aengland_challenge_loser
			remove_claim = e_aengland
		}
		FROM = {
			clr_character_flag = HK_aengland_challenged_oppositor
			set_character_flag = HK_aengland_challenge_winner
		}
	}

	on_reverse_demand = {
		clr_global_flag = HK_aengland_claim
		ROOT = {
			prestige = -150
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			participation_scaled_prestige = 150
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 150 }
		}
		ROOT = {
			clr_character_flag = HK_aengland_challenger
			set_character_flag = HK_aengland_challenge_loser
			remove_claim = e_aengland
			hidden_tooltip = {
				any_playable_ruler = {
					limit = {
						is_HK_aengland_relevant_trigger = yes
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = 3121698 }
				}
			}
		}
		FROM = {
			clr_character_flag = HK_aengland_challenged_oppositor
			set_character_flag = HK_aengland_challenge_winner
		}
	}
	
	on_invalidation = {
		clr_global_flag = HK_aengland_claim
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 90
	}
}


### VARIOUS CBs ###
raid_cb = {					# Raid (war for money)
	name = CB_RAID
	war_name = WAR_RAID
	sprite = 7
	truce_days = 720
	hostile_against_others = yes
	is_permanent = yes 
	check_all_titles = yes ## if permanent, setting this to true will check against all of someones titles, including vassal held titles
	can_call_allies = no
	can_call_vassals = yes
	can_attack_vassals = yes
	
	#battle_warscore_mult = 1.25
	
	defender_unoccupied_warscore = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = { 
			prestige = 100 
			NOT = { has_character_modifier = raider_timer }
		}
		FROM = { scaled_wealth = 2 }
	}

	can_use = {
		ROOT = {
			government = tribal_government
			NOT = { any_liege = { character = FROM } }
		}
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
						}
					}
				}
			}
		}
	}

	# is_valid = {
		# ROOT = {
			# is_tribal = yes		
		# }	
	# }

	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}	
	}
	
	on_add = {
		hidden_tooltip = {
			ROOT = {
				add_character_modifier = {
					name = raider_timer 
					duration = 1095
				}
			}
		}
	}
	
	on_success = {
		ROOT = { prestige = 100 }
		FROM = {
			if = {
				limit = { government = tribal_government }
				transfer_scaled_wealth = {
					to = ROOT
					value = 9
				}
			}
			else_if = {
				limit = { government = high_tribal_government }
				transfer_scaled_wealth = {
					to = ROOT
					value = 7
				}
			}
			else = {
				transfer_scaled_wealth = {
					to = ROOT
					value = 2.5
				}
			}
		}
		any_attacker = {
			participation_scaled_prestige = 50
			clr_character_flag = raider_timer_flag
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
	}

	on_fail = {
		ROOT = {
			prestige = -150
			clr_character_flag = raider_timer_flag			
		}
		any_attacker = {
			clr_character_flag = raider_timer_flag
		}
		any_defender = {
			participation_scaled_prestige = 100
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -300
			clr_character_flag = raider_timer_flag
		}
		any_attacker = {
			clr_character_flag = raider_timer_flag
		}
		FROM = {
			prestige = 200		
		}
	}
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 75
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 75
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 1
		modifier = {
			factor = 0.75
			FROM = {
				culture = ROOT
			}
		}
		modifier = {
			factor = 1.2
			FROM = {
				NOT = { culture = ROOT }
			}
		}
		modifier = {
			factor = 0.85
			FROM = {
				religion = ROOT
			}
		}
		modifier = {
			factor = 1.2
			FROM = {
				NOT = { religion = ROOT }
			}
		}
		modifier = {
			factor = 3
			ROOT = { government = tribal_government }
		}	
	}	
}

vassalize = {					# De Jure Subjugation (vassalize lower independent rulers of your culture group)
	name = CB_NAME_VASSALIZE
	war_name = WAR_NAME_VASSALIZE
	sprite = 6
	truce_days = 1095
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = {
			prestige = 300
		}
	}
	
	can_use = {
		FROM = {
			lower_tier_than = ROOT
			independent = yes
			culture_group = ROOT
			primary_title = {
				higher_tier_than = BARON
				dejure_liege_title = {
					OR = {
						ROOT = {
							OR = {
								has_landed_title = PREV
								any_vassal = {
									has_landed_title = PREVPREV
								}
							}
						}
						dejure_liege_title = {
							OR = {
								ROOT = {
									OR = {
										has_landed_title = PREV
										any_vassal = {
											has_landed_title = PREVPREV
										}
									}
								}
								dejure_liege_title = {
									ROOT = {
										has_landed_title = PREV
									}
								}
							}
						}
					}
				}
			}
			any_realm_province = {
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
		ROOT = {
			higher_tier_than = COUNT
			prisoner = no
			NOT = { government = tribal_government }
		}
		NAND = {			# Block Franks against Frisians
			ROOT = { 
				OR = {
					culture = oldfrankish
					culture = frankish
				}
			}
			FROM = { 
				OR = {
					culture = oldfrisian
					culture = frisian 
				}
			}
			NOT = { year = 650 }
		}
		NAND = {			# Block Franks against Saxons
			ROOT = { 
				OR = {
					culture = oldfrankish
					culture = frankish
				}
			}
			FROM = { 
				OR = {
					culture = oldsaxon
					culture = saxon
				}
			}
			NOT = { year = 700 }
		}
	}
	
	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}
		FROM = {
			has_landed_title = PREV
		}
		holder_scope = {
			NOT = { same_realm = ROOT }
		}
		NOT = {
			OR = {
				ROOT = {
					has_landed_title = PREV
				}
				holder_scope = {
					is_liege_or_above = ROOT
				}
			}
		}
	}
	
	is_valid = {
		FROM = {
			lower_tier_than = ROOT
			independent = yes
		}
	}
	
	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
	}
					
	on_success = {
		ROOT = {
			add_character_modifier = { name = victory_timer duration = 3 hidden = yes }
		}		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			hidden_tooltip = {
				opinion = {
					who = ROOT
					modifier = force_vassalized
					months = 120
				}
			}		
			set_defacto_liege = ROOT
		}
		# Transfer foederati
		hidden_tooltip = {
			ROOT = { character_event = { id = foederati.21 } }
		}
	}	

	on_fail = {
		ROOT = {
			prestige = -100
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}	
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}	
	
	ai_will_do = { 
		factor = 100
		modifier = {
			factor = 0
			NOT = { year = 490 }
			FROM = {
				primary_title = {
					OR = {
						title = d_hamaland
						title = d_salland
					}
				}
			}
			ROOT = {
				culture = oldfrankish
				capital_scope = {
					NOT = { region = world_germania }
				}
			}
		}
	}
}
vassalize_non_dejure = {				# Non-de jure Subjugation (vassalize lower independent rulers of your culture group)
	name = CB_NAME_VASSALIZE
	war_name = WAR_NAME_VASSALIZE
	sprite = 6
	truce_days = 1095
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allowed_to_target_tributaries = no
	
	on_add = {
		ROOT = { prestige = -750 }
	}
	
	can_use_gui = {
		ROOT = {
			prestige = 3000
			num_of_count_titles_in_realm = 6
			is_adult = yes
			OR = {
				prestige = 5000
				martial = 20
				AND = {
					martial = 15
					diplomacy = 15
				}
				trait = brilliant_strategist
				trait = skilled_tactician
			}
			NOR = {
				is_incapable = yes
				trait = weak
				trait = imbecile
				trait = slow
			}
			prisoner = no
			NOT = { has_character_modifier = vassalize_timer }
		}
	}
	
	can_use = {
		FROM = {
			lower_tier_than = ROOT
			independent = yes
			culture_group = ROOT
			NOT = {
				primary_title = {
					higher_tier_than = BARON
					dejure_liege_title = {
						OR = {
							ROOT = {
								OR = {
									has_landed_title = PREV
									any_vassal = {
										has_landed_title = PREVPREV
									}
								}
							}
							dejure_liege_title = {
								OR = {
									ROOT = {
										OR = {
											has_landed_title = PREV
											any_vassal = {
												has_landed_title = PREVPREV
											}
										}
									}
									dejure_liege_title = {
										ROOT = {
											has_landed_title = PREV
										}
									}
								}
							}
						}
					}
				}
			}
			any_realm_province = {
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
		ROOT = {
			higher_tier_than = COUNT
			NOT = { government = tribal_government }
		}
		NAND = {			# Block Franks against Frisians and Saxons
			ROOT = { 
				OR = {
					culture = oldfrankish
					culture = frankish
				}
			}
			FROM = { 
				is_ingvaeonic_culture_trigger = yes
				OR = {
					AND = {
						NOT = { year = 650 }
						OR = {
							capital_scope = { region = custom_frisia }
							primary_title = {
								capital_scope = { region = custom_frisia }
							}
						}
					}
					AND = {
						NOT = { year = 650 }
						OR = {
							capital_scope = { region = world_hamaland_salland }
							primary_title = {
								capital_scope = { region = world_hamaland_salland }
							}
						}
						has_global_flag = hamaland_conquered_saxon
					}
					AND = {
						NOT = { year = 700 }
						OR = {
							capital_scope = { region = world_germania_saxony }
							primary_title = {
								capital_scope = { region = world_germania_saxony }
							}
						}
					}
				}
			}
		}
		# Linnius/Lindsey Protection
		NAND = {
			FROM = { primary_title = { title = d_lindsey } }
			ROOT = {
				OR = {
					has_landed_title = k_anglia
					top_liege = { has_landed_title = k_anglia }
				}
				is_ingvaeonic_culture_trigger = yes
			}
			NOT = { year = 495 }
			OR = {
				NOT = { year = 440 }
				c_caistor = { holder_scope = { is_ingvaeonic_culture_trigger = yes } }
			}
		}
	}
	
	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}
		FROM = {
			has_landed_title = PREV
		}
		holder_scope = {
			NOT = { same_realm = ROOT }
		}
		NOT = {
			OR = {
				ROOT = {
					has_landed_title = PREV
				}
				holder_scope = {
					is_liege_or_above = ROOT
				}
			}
		}
	}
	
	is_valid = {
		FROM = {
			lower_tier_than = ROOT
			independent = yes
		}
	}
	
	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
	}
	
	on_add = {
		hidden_tooltip = {
			ROOT = {
				add_character_modifier = {
					name = vassalize_timer 
					duration = 3650
				}
			}
		}
	}
	
	on_success = {
		ROOT = {
			add_character_modifier = { name = victory_timer duration = 3 hidden = yes }
		}		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			hidden_tooltip = {
				opinion = {
					who = ROOT
					modifier = force_vassalized
					months = 120
				}
			}		
			set_defacto_liege = ROOT
		}
		# Transfer foederati
		hidden_tooltip = {
			ROOT = { character_event = { id = foederati.21 } }
		}
	}	

	on_fail = {
		ROOT = {
			prestige = -100
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}	
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 2
	}
}
vassalize_tribal = {					# Subjugation cb for Tribals
	name = CB_NAME_VASSALIZE
	war_name = WAR_NAME_VASSALIZE
	sprite = 6
	truce_days = 1095
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = { 
			is_adult = yes 
			is_incapable = no
			prisoner = no
			martial = 6
			NOT = { has_character_modifier = vassalize_timer }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { num_of_count_titles_in_realm = 9 } 
			}
			ROOT = { prestige = 4000 }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { 
					OR = {
						AND = {
							num_of_count_titles_in_realm = 3
							NOT = { government = tribal_government }
						}
						AND = {
							NOT = { num_of_count_titles_in_realm = 9 }
							num_of_count_titles_in_realm = 6 
							government = tribal_government
						}
					}
				}
			}
			ROOT = { prestige = 3000 }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = {
					OR = {
						AND = {
							NOT = { num_of_count_titles_in_realm = 3 } 
							NOT = { government = tribal_government }
						}
						AND = {
							NOT = { num_of_count_titles_in_realm = 6 }
							num_of_count_titles_in_realm = 3 
							government = tribal_government
						}
					}
				}
			}
			ROOT = { prestige = 2000 }
		}
		conditional_tooltip = {
			trigger = { 
				FROM = { 
					NOT = { num_of_count_titles_in_realm = 3 } 
					government = tribal_government
				}
			}
			ROOT = { prestige = 1000 }
		}
	}
	
	can_use = {
		FROM = {
			independent = yes
			OR = {
				is_tribal = yes
				lower_tier_than = ROOT
			}
			NOT = { num_of_count_titles_in_realm = 12 }
			NAND = {
				OR = {
					culture_group = celtic
					government = high_tribal_government
				}
				num_of_count_titles_in_realm = 6
			}
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
								OR = {
									is_isolated_island_trigger = yes
									PREVPREV = { is_isolated_island_trigger = yes }
								}
							}
						}
					}
				}
			}
		}
		ROOT = {
			independent = yes
			government = tribal_government
		}
		NAND = {			# Block Franks against Frisians
			ROOT = { 
				OR = {
					culture = oldfrankish
					culture = frankish
				}
			}
			FROM = { 
				OR = {
					culture = oldfrisian
					culture = frisian 
				}
			}
			NOT = { year = 650 }
		}
		NAND = {			# Block Franks against Saxons
			ROOT = { 
				OR = {
					culture = oldfrankish
					culture = frankish
				}
			}
			FROM = { 
				OR = {
					culture = oldsaxon
					culture = saxon
				}
			}
			NOT = { year = 700 }
		}
	}
	
	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}
		FROM = {
			has_landed_title = PREV
		}
		holder_scope = {
			NOT = { same_realm = ROOT }
		}
		NOT = {
			OR = {
				ROOT = {
					has_landed_title = PREV
				}
				holder_scope = {
					is_liege_or_above = ROOT
				}
			}
		}
	}
	
	is_valid = {
		FROM = {
			independent = yes
		}
	}
	
	on_add = {
		hidden_tooltip = {
			if = {
				limit = { FROM = { government = tribal_government } }
				ROOT = {
					add_character_modifier = {
						name = vassalize_timer 
						duration = 1095
					}
				}
			}
			else = {
				ROOT = {
					add_character_modifier = {
						name = vassalize_timer 
						duration = 1825
					}
				}
			}
		}
		if = {
			limit = { FROM = { government = tribal_government } }
			if = {
				limit = { FROM = { num_of_count_titles_in_realm = 9 } }
				ROOT = { prestige = -400 }
			}
			else_if = {
				limit = { FROM = { num_of_count_titles_in_realm = 6 } }
				ROOT = { prestige = -325 }
			}
			else_if = {
				limit = { FROM = { num_of_count_titles_in_realm = 3 } }
				ROOT = { prestige = -250 }
			}
			else = {
				ROOT = { prestige = -150 }
			}
		}
		else = {		# FROM is High Tribal
			if = {
				limit = { FROM = { num_of_count_titles_in_realm = 6 } }
				ROOT = { prestige = -400 }
			}
			else_if = {
				limit = { FROM = { num_of_count_titles_in_realm = 3 } }
				ROOT = { prestige = -325 }
			}
			else = {
				ROOT = { prestige = -250 }
			}
		}
	}
		
	on_success = {
		ROOT = {
			add_character_modifier = { name = victory_timer duration = 3 hidden = yes }
		}		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			hidden_tooltip = {
				opinion = {
					who = ROOT
					modifier = force_vassalized
					months = 120
				}
			}
			vassalize_under_ROOT_tribal_effect = yes
		}
	}	

	on_fail = {
		ROOT = {
			prestige = -100
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}	
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}	
	
	ai_will_do = { 
		factor = 2
	}
}
vassalize_frankish = {					# Special subjugation cb for Franks to unite
	name = CB_NAME_VASSALIZE
	war_name = WAR_NAME_VASSALIZE
	sprite = 6
	truce_days = 1095
	is_permanent = yes
	check_all_titles = yes
	can_ask_to_join_war = no
	can_call_allies = yes
	can_call_vassals = yes
	
	allowed_to_target_tributaries = no
	
	can_use = {
		NOT = { has_global_flag = frankish_kingdoms_united }
		ROOT = {
			has_character_flag = united_frankish_kingdoms
			prestige = 300
			prisoner = no
		}
		FROM = {
			OR = {
				culture = oldfrankish
				culture = frankish
			}
			lower_tier_than = KING
			primary_title = {
				kingdom = {
					OR = {
						title = k_franks
						title = k_ripuarian_franks
					}
				}
				NOT = {
					OR = {
						title = d_hamaland
						title = d_salland
					}
					duchy = {
						OR = {
							title = d_hamaland
							title = d_salland
						}
					}
				}
			}
		}
	}
	
	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}
		FROM = {
			has_landed_title = PREV
		}
		holder_scope = {
			NOT = { same_realm = ROOT }
		}
		NOT = {
			OR = {
				ROOT = {
					has_landed_title = PREV
				}
				holder_scope = {
					is_liege_or_above = ROOT
				}
			}
		}
	}
	
	is_valid_title = {
		FROM = {
			has_landed_title = PREV
		}
	}
	
	on_success = {
		ROOT = {
			add_character_modifier = { name = victory_timer duration = 3 hidden = yes }
		}		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 50
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			hidden_tooltip = {
				opinion = {
					who = ROOT
					modifier = force_vassalized
					months = 120
				}
			}		
			set_defacto_liege = ROOT
		}
	}	

	on_fail = {
		ROOT = {
			prestige = -100
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}	
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 3
	}
}
vassalize_foederati = {					# Special subjugation cb for foederati
	name = CB_NAME_VASSALIZE
	war_name = WAR_NAME_VASSALIZE
	sprite = 6
	truce_days = 1095
	is_permanent = no
	check_all_titles = yes
	can_ask_to_join_war = no
	can_call_allies = yes
	can_call_vassals = yes
	
	#allowed_to_target_tributaries = no
	
	can_use = {
		ROOT = { trait = foederate_employer }
		FROM = { trait = foederate }
	}
	
	can_use_title = {
		FROM = {
			primary_title = {
				title = PREVPREV
			}
		}
	}
	
	on_success = {
		ROOT = {
			add_character_modifier = { name = victory_timer duration = 3 hidden = yes }
		}		
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			hidden_tooltip = {
				opinion = {
					who = ROOT
					modifier = force_vassalized
					months = 120
				}
			}		
			set_defacto_liege = ROOT
		}
		hidden_tooltip = {
			ROOT = { make_tributary = { who = FROM tributary_type = foederati } }
			FROM = { character_event = { id = foederati.35 } }
		}
	}	

	on_fail = {
		ROOT = {
			prestige = -100
		}
		hidden_tooltip = {
			ROOT = { make_tributary = { who = FROM tributary_type = foederati } }
			FROM = { character_event = { id = foederati.37 } }
		}
	}

	on_reverse_demand = {
		FROM = { add_character_modifier = { name = victory_timer duration = 3 hidden = yes } }
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		hidden_tooltip = {
			ROOT = { make_tributary = { who = FROM tributary_type = foederati } }
			FROM = { character_event = { id = foederati.39 } }
		}
	}	
	
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 0
	}
}
viking_invasion_britannia = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 20
	truce_days = 720
	hostile_against_others = no # Vikings share in the spoils...
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = DUKE # this scans all de jure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no # Do not apply the 'recently_conquered' modifier to Holdings
	
	allowed_to_target_tributaries = no
	
	can_use = {
		ROOT = {
			has_character_flag = viking_invader
			culture = dane
			OR = {
				religion = norse_pagan
				religion = norse_pagan_reformed
			}
			independent = yes
		}
		FROM = { 
			NOR = { 
				culture = dane 
				culture = proto_norse
			} 
		}
	}
	
	can_use_title = {	
		# The attacker needs a border with the realm and the target duchy, or be only one sea zone away from one of your counties
		OR = {
			any_direct_de_jure_vassal_title = {
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
				}
				OR = {
					location = {
						any_neighbor_province = {
							OR = {
								AND = {
									has_owner = yes
									owner = {
										OR = {
											character = ROOT
											is_liege_or_above = ROOT
										}
									}
								}
	#							AND = {
	#								is_land = no
	#								any_neighbor_province = {
	#									has_owner = yes
	#									owner = {
	#										OR = {
	#											character = ROOT
	#											is_liege_or_above = ROOT
	#										}
	#									}
	#								}
	#							}
							}
						}
					}
					any_direct_de_jure_vassal_title = {
						holder_scope = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
			}
			ROOT = { is_landed = no }	# For initial invasions
		}
	}
	
	is_valid = {
		ROOT = {
			has_character_flag = viking_invader
			culture = dane
			OR = {
				religion = norse_pagan
				religion = norse_pagan_reformed
			}
		}
	}
	
	on_success = {
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 150
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		FROM = {
			prestige = -200
		}
		hidden_tooltip = {
			ROOT = {
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = FROM
			}
		}
	}
	
	on_success_title = {
		custom_tooltip = {
			text = viking_invasion_britannia_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					gain_settlements_under_title = {
						title = PREV
						enemy = FROM
					}
				}
				any_direct_de_jure_vassal_title = {
					limit = {
						holder_scope = {
							character = ROOT
						}
					}
					conquest_culture = ROOT
				}
			}
		}
	}
	
	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = 125
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 3
		modifier = {
			factor = 5
			empire = {
				title = e_danes
			}
		}	
		modifier = {
			factor = 4
			OR = {
				kingdom = {
					OR = {
						title = k_anglia
						title = k_eastseaxe
						title = k_icenia
						title = k_elmet
					}
				}
				title = d_deira
				title = d_southumbria
				title = d_lindsey
				title = d_eastgwent
			}
		}
#		modifier = {
#			factor = 0.3
#			NOT = {
#				OR = {
#					kingdom = {
#						OR = {
#							title = k_anglia
#							title = k_eastseaxe
#							title = k_icenia
#							title = k_elmet
#						}
#					}
#					title = d_deira
#					title = d_southumbria
#					title = d_lancaster
#					title = d_lindsey
#					title = d_eastgwent
#				}
#			}
#		}		
	}
}
pagan_subjugation_high_kingdom = {
	name = CB_NAME_PAGAN_SUBJUGATION
	war_name = WAR_NAME_PAGAN_SUBJUGATION
	sprite = 8
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	check_de_jure_tier = EMPEROR # this scans all de jure kingdoms for the counties which are held by or vassals (or below) of selected character. Only valid if is_permanent = yes
	
#	prestige_cost = 100

	can_use_gui = {
		ROOT = {
			is_adult = yes
			is_incapable = no
			prestige = 2000
			ruled_years = 10
			NOT = { has_character_modifier = vassalize_tribal_timer }
		}
	}

	can_use = {
		ROOT = {
			government = high_tribal_government
			has_ambition = obj_become_high_king
			#culture = dane
			independent = yes
			NOT = { same_realm = FROM }
			NOT = { is_liege_or_above = FROM }
			capital_scope = {
				empire = {
					OR = {
						title = e_denmark
						title = e_norway
						title = e_sweden
						title = e_geatland
					}
				}
			}
		}
		FROM = {
			is_tribal = yes
			culture_group = ROOT
			NOT = {
				any_war = {
					AND = {
						defender = { character = FROM }
						OR = {
							using_cb = pagan_subjugation
							using_cb = pagan_subjugation_high_kingdom
						}
					}
				}
			}
		}
	}
	
	can_use_title = {
		ROOT = {
			capital_scope = {
				empire = {
					title = PREVPREVPREV
				}
			}
		}

		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	
	on_add = {
		ROOT = {
			prestige = -300
			hidden_tooltip = {
				add_character_modifier = {
					name = vassalize_tribal_timer 
					duration = 1095
				}
			}
		}
	}

	on_success = {
		if = {
			limit = { religion_group = pagan_group }
			ROOT = {
				piety = 50
			}
		}
		ROOT = {
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		FROM = {
			if = {
				limit = { religion_group = pagan_group }
				piety = -100
			}
			prestige = -100
		}
	}
	
	on_success_title = {
		custom_tooltip = {  
			text = pagan_subjugation_succ_tip
		}
		ROOT = {
			hidden_tooltip = {
				vassalize_or_take_under_title = {
					title = PREV
					enemy = FROM
				}
			}
		}
	}

	on_fail = {
		FROM = {
			piety = 50
		}
		FROM = {
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		ROOT = {
			piety = -100
		}
	}
	
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 50
		}
		FROM = {
			if = {
				limit = { 
					has_dlc = "Legacy of Rome"
					is_roman_emperor_trigger = yes
					OR = {
						religion_group = christian
						religion_group = zoroastrian_group
					}
				}
				hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
			}
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

overthrow_ruler_tribal_war = {
	name = CB_NAME_OVERTHROWRULER
	war_name = WAR_NAME_OVERTHROWRULERTRIBAL
	sprite = 6
	truce_days = 1825
	can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}
	
	can_use_title = {
		higher_tier_than = BARON
		is_primary_holder_title = yes
	}
	
	is_valid = {
		FROM = {
			in_revolt = no
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = { 
					FROM = { 
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}

	on_success = {
		any_attacker = {
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = { 
			hidden_tooltip = { disband_event_forces = faction_loyalists }
			show_scope_change = no
			if = {
				limit = { tier = COUNT }
				any_demesne_title = {
					limit = { tier = COUNT }
					show_scope_change = no
					ROOT = {
						show_scope_change = no
						usurp_title = {
							target = PREV
							type = faction_demand
						}
					}
				}
			}
			else_if = {
				limit = { tier = DUKE }
				any_demesne_title = {
					limit = { tier = DUKE }
					show_scope_change = no
					ROOT = {
						show_scope_change = no
						usurp_title = {
							target = PREV
							type = faction_demand
						}
					}
				}
			}
			else_if = {
				limit = { tier = KING }
				any_demesne_title = {
					limit = { tier = KING }
					show_scope_change = no
					ROOT = {
						show_scope_change = no
						usurp_title = {
							target = PREV
							type = faction_demand
						}
					}
				}
			}
			else_if = {
				limit = { tier = EMPEROR }
				any_demesne_title = {
					limit = { tier = EMPEROR }
					show_scope_change = no
					ROOT = {
						show_scope_change = no
						usurp_title = {
							target = PREV
							type = faction_demand
						}
					}
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		
		FROM = {
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 50 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
			}
		}
		FROM = { 
			hidden_tooltip = { 
				disband_event_forces = faction_loyalists
			}
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}

		
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		
		hidden_tooltip = {
			any_attacker = {
				limit = { liege = { character = FROM } }
				prisoner = FROM
				disband_event_forces = faction_revolters
			}
		}
		FROM = { 
			hidden_tooltip = { 
				disband_event_forces = faction_loyalists
			}
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Roman deposition of Gallic Emperors
gallic_deposition = {
	name = CB_NAME_GALLIC_DEPOSITION
	war_name = WAR_NAME_GALLIC_DEPOSITION
	sprite = 17
	truce_days = 1095
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	can_call_allies = yes
	can_call_vassals = yes
	can_ask_to_join_war = no
	reflect_titleholder_change = yes
	
	allow_distant = yes
	
	can_use = {
		ROOT = {
			NOT = { same_realm = FROM }
			has_landed_title = e_western_roman_empire
			is_female = no
			independent = yes
			prisoner = no
		}
	}

	is_valid = {
		ROOT = {
			NOT = { same_realm = FROM }
			has_landed_title = e_western_roman_empire
		}
	}
	
	on_success = {
		ROOT = {
			prestige = 500
		}
		ROOT = {
			participation_scaled_prestige = 500
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 500 }
		}
		
		FROM = {
			prestige = -500
			imprison = ROOT
		}
	}

	on_success_title = {
		# Transfer all legions to the appropriate provincial governor
		FROM = {
			any_vassal = {
				limit = { government = legion_government }
				primary_title = {
					capital_scope = {
						kingdom = {
							holder_scope = {
								set_defacto_vassal = PREVPREVPREVPREV
							}
						}
					}
				}
			}
			hidden_tooltip = {
				any_vassal = {
					limit = { tier = KING }
					set_defacto_liege = THIS
					ROOT = { make_tributary = { who = PREV tributary_type = roman_province } }
					set_government_type = imperial_government
				}
			}
		}
		hidden_tooltip = {
			any_playable_ruler = {
				limit = { 
					is_tributary = {
						type = foederati
						suzerain = FROM 
					}
					NOT = { has_landed_title = k_franks }
				}
				FROM = { remove_tributary = PREV }
				ROOT = { make_tributary = { who = PREV tributary_type = foederati } }
			}
		}
		e_gaul = {
			destroy_landed_title = THIS 
		}
		if = {
			limit = {
				k_lugdunesis_quartia = {
					has_holder = yes
					holder_scope = {
						NOT = { character = FROM }
					}
				}
			}
			k_lugdunesis_quartia = {
				holder_scope = {
					FROM = {
						abdicate_to = PREV
					}
				}
			}
			break = yes
		}
		FROM = { abdicate_to_most_liked_by = ROOT }
	}

	on_fail = {
		ROOT = {
			prestige = -200
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -500
			transfer_scaled_wealth = {
				to = FROM
				value = 5.0
			}
		}
		FROM = {
			prestige = 500
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

#	on_reverse_demand_title = {
#	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	ai_will_do = { 
		factor = 10
		modifier = {
			factor = 5
			FROM = {
				NOT = { religion_group = ROOT }
			}
		}		
	}
}

# Great Saxon Revolt
saxon_revolt = {
	name = CB_NAME_SAXON_REVOLT
	war_name = WAR_NAME_SAXON_REVOLT
	sprite = 12
	truce_days = 1
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	can_call_vassals = yes
	can_ask_to_join_war = no
	reflect_titleholder_change = yes
	
	battle_warscore_mult = 0.05
	
	can_use = {
		ROOT = { is_ingvaeonic_culture_trigger = yes }
		ROOT = { has_character_flag = saxon_revolter }
	}
	
	#attacker_alliance_occ_warscore = no
	
	attacker_ai_victory_worth = { 
		factor = 100 
	}
	
	attacker_ai_defeat_worth = { 
		factor = 100 
	}
	
	defender_ai_victory_worth = { 
		factor = 100 
	}
	
	defender_ai_defeat_worth = { 
		factor = 100 
	}
	
	on_success  = {
		prestige = 100
	}
	
	on_fail = {
		prestige = -50
	}
	
	on_reverse_demand = {
		prestige = -200
	}
	
	ai_will_do = {
		factor = 0
	}
}
visigoth_reconquest = {
	name = CB_NAME_VISIGOTH_RECONQUEST
	war_name = WAR_NAME_VISIGOTH_RECONQUEST
	sprite = 8
	truce_days = 1095
	hostile_against_others = yes
	can_ask_to_join_war = yes
	is_permanent = yes
	
	allowed_to_target_tributaries = no
	
	can_use_gui = {
		ROOT = {
			prestige = 500
			NOR = {
				trait = craven
				trait = weak
				trait = incapable
				trait = imbecile
			}
		}
	}

	can_use = {
		ROOT = {
			OR = {
				has_landed_title = k_visigoths
				AND = {
					has_landed_title = e_visigoths
					e_visigoths = { has_title_flag = empire_claimed_visigoths }
				}
			}
			independent = yes
		}
		OR = {
			AND = {
				has_global_flag = visigoths_reconquest_1
				NOT = {
					had_global_flag = {
						flag = visigoths_reconquest_1
						days = 10950
					}
				}
				FROM = {
					any_realm_province = {
						region = custom_southaquitania
						any_neighbor_province = {
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
					}
				}
			}
			AND = {
				has_global_flag = visigoths_reconquest_2
				NOT = {
					had_global_flag = {
						flag = visigoths_reconquest_2
						days = 10950
					}
				}
				FROM = {
					any_realm_province = {
						region = world_gaul_aquitania
						any_neighbor_province = {
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
					}
				}
			}
		}
	}
	
	can_use_title = {
	}

	on_success = {
		ROOT = {
			participation_scaled_prestige = 200
		}
		any_attacker = {
			limit = {
				character = ROOT
				NOT = { religion_group = christian }
			}
			piety = 150
		}
		any_attacker = {
			limit = { NOT = { character = ROOT } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
		ROOT = {
			prestige = 200
		}
		FROM = {
			prestige = -200
		}
	}
	
	on_success_title = {
		if = {
			limit = {
				has_global_flag = visigoths_reconquest_2
			}
			custom_tooltip = {  
				text = visigoths_reconquest_2_succ_tip
			}	
			hidden_tooltip = {		# Usurp or vassalize all titles in Aquitania
				FROM = {
					save_event_target_as = target_defender
				}
				ROOT = { character_event = { id = 301211 } }
			}
			break = yes
		}
		custom_tooltip = {  
			text = visigoths_reconquest_1_succ_tip
		}	
		hidden_tooltip = {		# Usurp or vassalize all titles in Southern Aquitania
			FROM = {
				save_event_target_as = target_defender
			}
			ROOT = { character_event = { id = 301210 } }
		}
	}

	on_fail = {
		FROM = {
			prestige = 100
		}
		FROM = {
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 100 }
		}
		ROOT = {
			prestige = -200
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
		FROM = {
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = { NOT = { character = FROM } }
			hidden_tooltip = { participation_scaled_prestige = 200 }
		}
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 95
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 95
	}
	
	# ai importance placed on this CB: scope is the targeted title, ROOT is the attacking character, FROM is the defending character
	ai_will_do = { 
		factor = 10000
	}
}

tributary_client_state_cb = {
	name = CB_NAME_CLIENT_STATE
	war_name = WAR_NAME_CLIENT_STATE
	sprite = 37
	truce_days = 365
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = no
	display_on_map = no
	allowed_to_target_tributaries = no
	
	defender_unoccupied_warscore = yes
	
	can_use_gui = {
		ROOT = {
			relative_realm_size = {
				who = FROM 
				size > 3
			}
			prestige = 1000
		}
	}
	
	can_use = {
		ROOT = {
			is_romanized_government_trigger = yes
			is_nomadic = no
			independent = yes
			mercenary = no
			is_tributary = no
			NOT = { is_vassal_or_below = FROM }
			NOT = { is_liege_or_above = FROM }
			NOT = {
				rightful_religious_head_scope = {
					character = FROM
				}
			}
			NAND = {
				holy_order = yes
				religion = FROM
			}
		}
		FROM = {
			is_nomadic = no
			higher_tier_than = BARON
			NOT = {
				is_offmap_governor = yes
			}
			NAND = {
				holy_order = yes
				religion = ROOT
			}
			independent = yes
			NOT = {
				suzerain = {
					OR = {
						character = ROOT
						any_liege = {
							character = ROOT
						}
					}
				}
			}
		}
		
		# The attacker needs a border, or be at most one sea zone away from one of the target's counties
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					has_owner = yes
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
		
		# The defender is not in any tributary war
		FROM = {
			NOR = {
				any_war = {
					using_cb = tributary_cb
				}
				any_war = {
					using_cb = tributary_permanent_cb
				}
				any_war = {
					using_cb = tributary_nomad_cb
				}
				any_war = {
					using_cb = tributary_client_state_cb
				}
			}
		}
	}

	is_valid = {
		NOT = {
			ROOT = {
				rightful_religious_head_scope = {
					character = FROM 
				}
			}
		}
	}

	on_add = {
		# Chance to surrender early
		ROOT = { save_event_target_as = tribute_war_suzerain }
		FROM = {
			save_event_target_as = tribute_war_target
			set_character_flag = surrender_tributary_client_state_cb
			character_event = { id = JD.2500 days = 5 tooltip = surrender_tributary_tt }
		}
	}

	on_success = {
		FROM = {
			save_event_target_as = target_loser
			prestige = -100
			custom_tooltip = {
				text = "REMOVE_PREVIOUS_SUZERAIN"
				hidden_tooltip = {
					any_suzerain = {
						event_target:target_loser = {
							remove_tributary = PREV
						}
					}
				}
			}
			opinion = {
				modifier = opinion_forced_tributary 
				who = ROOT
				years = 15
			}
		}

		ROOT = {
			prestige = 200
			make_tributary = { who = FROM tributary_type = client_state }
		}
		
		if  = {
			limit = {
				ROOT = {
					uses_decadence = yes
				}
			}
			ROOT = {
				decadence = -10
			}
		}
		if  = {
			limit = {
				ROOT = {
					is_nomadic = yes
				}
			}
			ROOT = {
				clan_title = {
					ROOT = {
						any_vassal = {
							limit = { is_nomadic = yes }
							clan_title = {
								clan_opinion = {
									who = PREVPREVPREV
									modifier = won_tributary_war
									years = 5
								}
							}
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				ROOT = {
					is_tribal = yes
				}
			}
			ROOT = {
				any_vassal = {
					limit = { is_tribal = yes }
					opinion = {
						who = PREV
						modifier = won_tributary_war
						years = 5
					}
				}
			}
		}
	}

	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = 100
		}
	}

	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}

		FROM = {
			prestige = 200
		}
	}
	
	on_attacker_leader_death = {
		end_war = invalid
	}

	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	attacker_ai_defeat_worth = {
		factor = 100
	}

	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	
	defender_ai_defeat_worth = {
		factor = 100
	}

	ai_will_do = {
		factor = 1
		
		modifier = {
			factor = 0.5  # Low prio CB
		}
	}
}