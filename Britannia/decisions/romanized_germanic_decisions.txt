decisions = {
	visigoths_call_ostrogoths_to_war = {
		only_independent = yes
		is_high_prio = yes
		potential = {
			ai = no
			has_landed_title = k_visigoths
			independent = yes
			has_global_flag = ostrogoths_promised_aid_visigoths
			NOT = { has_global_flag = called_on_ostrogothic_aid_visigoths }
			suzerain = { has_landed_title = k_ostrogoths }
			NOT = { has_global_flag = gothic_war_started }
		}
		allow = {
			any_war = {
				using_cb = visigoth_reconquest
			}
		}
		effect = {
			custom_tooltip = {
				text = visigoths_call_ostrogoths_to_war_tooltip
			}
			hidden_tooltip = {
				character_event = { id = 302825 }
				set_global_flag = called_on_ostrogothic_aid_visigoths
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0 # Handled by event
		}
	}
	
	claim_provence = {
		only_independent = yes
		is_high_prio = yes
		potential = {
			primary_title = { title = k_burgundy }
			NOT = { has_global_flag = burgundy_subjugated }
			NAND = {
				has_global_flag = northern_provence_conquered_burgundians 
				has_global_flag = southern_provence_conquered_burgundians 
			}
			is_feudal = yes
			independent = yes
			NOT = { has_character_flag = has_claimed_provence }
			NAND = {
				c_arelate = { holder_scope = { top_liege = { character = ROOT } } }
				c_aquae_sextiae = { holder_scope = { top_liege = { character = ROOT } } }
				c_massilia = { holder_scope = { top_liege = { character = ROOT } } }
			}
			any_realm_province = {
				any_neighbor_province = {
					NOT = { owner = { top_liege = { character = ROOT } } }
					region = custom_provence
				}
			}
		}
		allow = {
			conditional_tooltip = {
				trigger = {
					k_visigoths = {
						holder_scope = {
							NOT = { character = ROOT }
							OR = {
								c_arelate = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
								c_aquae_sextiae = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
								c_massilia = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
							}
						}
					}
				}
				k_visigoths = {
					holder_scope = {
						OR = {
							NOR = {
								completely_controls = c_poitou
								completely_controls = c_santonorum
								completely_controls = c_burdigala
							}
							NOR = {
								completely_controls = c_bourges
								completely_controls = c_limoges
								completely_controls = c_alvernia
							}
							NOR = {
								completely_controls = c_tolosa
								completely_controls = c_narbo
							}
						}
					}
				}
			}
			conditional_tooltip = {
				trigger = {
					NOT = {
						k_visigoths = {
							NOT = { character = ROOT }
							holder_scope = {
								OR = {
									c_arelate = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
									c_aquae_sextiae = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
									c_massilia = { holder_scope = { any_liege = { character = PREVPREVPREV } } }
								}
							}
						}
					}
				}
				OR = {
					c_arelate = {
						holder_scope = {
							top_liege = {
								NOT = { character = ROOT }
								realm_size = 10
								NOT = { realm_size = 50 }
							}
						}
					}
					c_aquae_sextiae = {
						holder_scope = {
							top_liege = {
								NOT = { character = ROOT }
								realm_size = 10
								NOT = { realm_size = 50 }
							}
						}
					}
					c_massilia = {
						holder_scope = {
							top_liege = {
								NOT = { character = ROOT }
								realm_size = 10
								NOT = { realm_size = 50 }
							}
						}
					}
				}
			}
			is_adult = yes
			prestige = 1000
			realm_size = 70
			wealth = 200
			NOT = { trait = incapable }
		}
		effect = {
			wealth = -100
			custom_tooltip = {
				text = claim_provence_tooltip
			}
			set_character_flag = has_claimed_provence
			set_character_flag = claimed_provence
			# If AI takes the decision, they declare war immediately and get some event troops
			hidden_tooltip = {
				if = {
					limit = { 
						ai = yes
						NOT = { has_global_flag = burgundy_claimed_provence_before }
					}
					if = {
						limit = {
							NOT = { c_arelate = { holder_scope = { top_liege = { character = ROOT } } } }
						}
						c_arelate = {
							reverse_unsafe_war = {
								target = ROOT
								casus_belli = provence_conquest
							}
						}
					}
					else_if = {
						limit = {
							NOT = { c_aquae_sextiae = { holder_scope = { top_liege = { character = ROOT } } } }
						}
						c_aquae_sextiae = {
							reverse_unsafe_war = {
								target = ROOT
								casus_belli = provence_conquest
							}
						}
					}
					else_if = {
						limit = {
							NOT = { c_massilia = { holder_scope = { top_liege = { character = ROOT } } } }
						}
						c_massilia = {
							reverse_unsafe_war = {
								target = ROOT
								casus_belli = provence_conquest
							}
						}
					}
					# This shouldn't be possible, but just in case
					else = {
						random_neighbor_independent_ruler = {
							limit = {
								any_realm_province = {
									region = world_provence
									any_neighbor_province = {
										owner = {
											top_liege = {
												character = ROOT
											}
										}
									}
								}
							}
							random_realm_province = {
								limit = {
									region = world_provence
									any_neighbor_province = {
										owner = {
											top_liege = {
												character = ROOT
											}
										}
									}
								}
								reverse_unsafe_war = {
									target = ROOT
									casus_belli = provence_conquest
								}
							}
						}
					}
					if = {
						limit = { war = yes }
						capital_scope = {
							ROOT = {
								spawn_unit = {
									province = PREV
									home = PREV
									troops = {
										light_infantry = { 1000 1000 }
										heavy_infantry = { 500 500 }
										pikemen = { 450 450 }
										archers = { 250 250 }
										light_cavalry = { 75 75 }
									}
									attrition = 0.5
								}
							}
						}
					}
				}
			}
			set_global_flag = burgundy_claimed_provence_before
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1 # On average ca 1 year before taken
			modifier = {
				factor = 0
				war = yes
			}
		}
	}
}